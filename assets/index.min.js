const t=""+new URL("out_0-B8fN1_KR.png",import.meta.url).href,i=[{n:"Level_0",w:82,t:34,i:"AQSHAEkwSjBLMFEwAjRJNEo0SzRRNFE4UTxRQFFEUUgETAVMBkwHTAhMCUwKTAtMFEwVTBZMF0wYTB9MIEwhTCJMI0wkTCVMJkxRTARQBVAGUAdQCFAJUApQC1BRUARUBVQGVAdUCFQJVApUC1RRVFFYUVwYcBd0GHQWeBd4GHgqeBV8FnwXfBh8O3w8fD18PnwUgBWAFoAXgBiAGYAagBuAHIAdgB6AH4AggCGAIoAjgCSAJYAmgCeAKIA7gACEAYQChAOEBIQFhAaEB4QIhAmECoQLhAyEDYQOhA+EEIQRhBKEE4QUhBWEFoQXhBiEGYQahBuEHIQdhB6EH4QghCGEIoQjhCSEJYQmhCeEKIQ7hAAQBAAvfDN8Nnw6fAEQBwA/bCp8MHw0fDd8KYA8gAEMBAA/aCt4NHgZfAAMDAACMEg0UFwXcBZ0KnQVeDN4PngUfCl8E4AABCUASDBQMAE0UDRQOD48UDw+QFBAPkRQRD5IUEgDTBNMHkw+TFBMA1A+UFBQA1Q+VFBUPlhQWD5cPmA+ZD5oPmw+cDN0PnQpeDqAOoQBCFwACCwJLAosCywMLA0sDiwPLBAsFywYLBksGiwbLBwsHSweLB8sICwhLCgsKSwqLCssLCw0LDUsNiw3LDgsAjgDOEI4QzhEOEU4RjhHOEg4SThKOEs4FFAVUBZQF1AYUB9QIFAhUCJQI1AkUCVQJlAEWAVYBlgHWAhYCVgKWAtYSGBJYEpgS2BMYE1gTmBPYFBgUWAvaEBsQWxCbCt8LHwtfC58MXwyfDV8OHw5fE18TnxPfFB8PYA+gAIEHwADMEwwAzRMND88P0A/RD9IDEwZTCdMP0wMUD9QDFQ/VD9YP1w/YD9kGXA/cBl0K3Q0dD90GXg/eD98KYQ8hAEAfgAIKAkoCigLKAwoDSgOKA8oECgXKBgoGSgaKBsoHCgdKB4oHyggKCEoKCgpKCooKygsKDQoNSg2KDcoOChJLEosSyxRLEM0RDRFNEY0RzQ/OARIBUgGSAdICEgJSApIC0gUSBVIFkgXSBhIH0ggSCFIIkgjSCRIJUgmSEhcSVxKXEtcTFxNXE5cT1wvZEBoQWhCaBhsLHgteC54L3gweDF4Mng1eDZ4N3g4eDl4Ong7eDx4PXhOeE94GnwbfBx8HXwefB98IHwhfCJ8I3wkfCV8JnwnfCh8AIABgAKAA4AEgAWABoAHgAiACYAKgAuADIANgA6AD4AQgBGAEoAACA0ABywWLCcsMywBOBNQHlADWEdgLmgvgDOANoACCA8AESwiLC0sOSxMOBlQJ1AMWDBoQ2wqgDCANIA3gD+AAgAPABEoIigtKDkoAyxMLAxIGUgnSDBkQ2gZbCtwNHBQeAAAGAAHKBYoJygzKAIsSCxQLAEwQjQ+OANIE0geSEdcLmQXbBZwKnAzcBV0KXQUeE14E3wEAA4ABDhAOEE4H3AgcEV8RnxHfEh8SXxKfEt8THxRfAUAAgAFOCFwAwACAB5wRHwTTAEABnwRTDAACBQVFCYUMhRAFEQUThQGGAoYExgXGCQYKBgwGDQYPhxCHEUcTiBOMBA8HDxOPARAB0AJQCRAJkBOSD1UTlRLWCxcLlwwXDJcPVxDXBhkPWQdaB9oIWgjaBVwLnQxdBN4EkwLAAokHCQ2JEUwB0QgRElYOXQheEl4SYQ="}];function s(t){function i(t){function i(t){return[4*(t%1024),4*Math.floor(t/1024)]}let s=[],e=function(t){const i=atob(t),s=i.length,e=new Uint8Array(s);for(let h=0;h<s;h++)e[h]=i.charCodeAt(h);return new Uint16Array(e.buffer)}(t);for(let h=0;h<e.length;){let t=e[h];h++;let n=e[h];h++;let r=[...e.slice(h,h+n)];h+=n,s.push(...r.map((s=>({src:i(t),px:i(s)}))))}return s}return t.map((t=>{let{n:s,w:e,t:h,i:n}=t;return{name:s,w:e,t:h,i:i(n)}}))}const e=new class{image;info;h;o;async load(){var e;this.image=await(e=t,new Promise((t=>{let i=new Image;i.onload=()=>t(i),i.src=e}))),this.info="bullet\n\n0*0*idle\n\n0*144*170\n\n\ncollect\n\n0*2*coin\n\n0*144*178\n0*144*200\n0*144*208\n\n\ncrash\n\n0*2*idle\n\n0*80*216\n0*88*216\n0*96*216\n\n\ncrawler\n\n0*1*idle\n\n0*104*216\n0*112*216\n\n\nfx_collect\n\n0*2*idle\n\n0*120*216\n0*128*216\n0*136*216\n\n\nfx_djump\n\n0*1*idle\n\n0*144*216\n0*80*186\n\n\nfx_flash\n\n0*1*idle\n\n0*88*186\n0*96*186\n\n\nloading\n\n0*1*audio\n2*4*input\n\n4*0*80\n4*0*110\n4*0*140\n4*0*170\n4*0*200\n\n\nmain_char\n\n0*1*idle\n2*3*run\n4*6*jump\n7*9*die\n\n0*104*186\n0*112*186\n0*120*186\n0*128*186\n0*136*186\n0*144*186\n0*80*140\n0*88*140\n0*96*140\n0*104*140\n\n\nnpc\n\n0*0*idle\n\n3*80*200\n\n\ntest\n\n0*2*idle\n3*4*attack\n\n1*128*200\n1*80*170\n1*96*170\n1*112*170\n1*128*170\n\n\ntiles\n\n0*0*idle\n\n2*0*0".split(/\r?\n\r?\n\r?\n/).map((t=>{let[i,s,e]=t.split(/\r?\n\r?\n/);return{name:i,tags:s.split(/\r?\n/).map((t=>{let[i,s,e]=t.split("*");return{from:parseInt(i),to:parseInt(s),name:e}})),l:e.split(/\r?\n/).map((t=>{let[i,s,e,h,n,r,a,o]=function(t){let[i,s,e]=t,h=0,n=0,[r,a]=0===i?[8,8]:1===i?[16,16]:2===i?[80,80]:4===i?[80,30]:[0,0],[o,l]=[r,a];return[h,n,r,a,s,e,o,l]}(t.split("*").map((t=>parseInt(t))));return{fx:i,fy:s,A:e,u:h,_:n,B:r,M:a,m:o}}))}})),this.o=this.info.find((t=>"tiles"===t.name)).l[0],console.log(this.info),this.h=s(i)}};class h{constructor(t,i){this.canvas=t,this.p=i}get width(){return this.canvas.width}get height(){return this.canvas.height}clear(){let{p:t}=this;t.clearRect(0,0,this.width,this.height)}fr(t,i,s,e,h){let{p:n}=this;n.fillStyle=h,n.fillRect(t,i,s,e)}C(t,i){let{p:s}=this;s.save(),s.translate(Math.floor(t),Math.floor(i))}pop(){let{p:t}=this;t.restore()}v(t,i,s,e=1,h=1){let{fx:n,fy:r,_:a,B:o,M:l,m:A}=t.D,{I:c,U:d}=t,u=i-n-c,f=s-r-d;this.F(u,f,a,o,l,A,e,h)}R(t,i,s){let{fx:h,fy:n,_:r,B:a}=e.o,o=i-h,l=s-n,A=t%20*4,c=4*Math.floor(t/20);this.F(o,l,r+A,a+c,4,4)}F(t,i,s,h,n,r,a=1,o=1){let{p:l}=this,{image:A}=e;l.save();let c=n,d=r,u=c*Math.abs(a),f=d*Math.abs(o);l.scale(Number(a.toFixed(2)),Number(o.toFixed(2))),a<0&&(t*=-1,t-=u),o<0&&(i*=-1,i-=f),l.drawImage(A,s,h,c,d,Math.round(t),Math.round(i),Math.round(u),Math.round(f)),l.restore()}}const n={k:16,time:0,H(t,i=0){let{k:s,time:e}=this;return Math.floor((e-i-s)/t)<Math.floor((e-i)/t)}};class r{K;L(t){return this.K=t,this}visible=!0;parent;S;Y;O;T;V(t,i){this.T.push([t,i])}constructor(){this.O=[],this.Y=[],this.T=[]}N(t){return this.Y.filter((i=>i instanceof t))}P(t){return this.Y.find((i=>i instanceof t))}G(t,i){let s=(new t).L(i).init();return s.parent=this,s}J(t,i={}){let s=this.G(t,i);return this.Y.push(s),s}X(t,i={},s=7){let e=this.G(t,i);return this.Y.push(e),this.O.push([e,s]),e}remove(t){if(!t)return void this.parent?.remove(this);let i=this.Y.indexOf(t);if(-1===i)throw"noscene rm";this.Y.splice(i,1),i=this.O.findIndex((([i])=>i===t)),-1!==i&&this.O.splice(i,1)}init(){return this.S=0,this.W(),this}update(){this.visible&&(0===this.S&&this.j(),this.Y.forEach((t=>t.update())),this.S+=n.k,this.T=this.T.map((([t,i])=>(t-n.k<0&&i(),[t-n.k,i]))).filter((t=>t[0]>0)),this.O.slice(0).forEach((([t,i])=>{let s=this.O.filter((i=>i[0].constructor.name===t.constructor.name));if(s.length>i){let t=s[0][0];this.remove(t)}})),this.Z(),this.q())}draw(t){this.visible&&(this.$(t),this.Y.forEach((i=>i.draw(t))),this.tt(t))}W(){}j(){}Z(){}q(){}tt(t){}$(t){}}class a extends r{get data(){return this.K}get info(){let t=e.info.find((t=>t.name===this.it));if(!t)throw`nosprite ${this.it}`;return t}get duration(){return this.data.duration??400}set duration(t){this.data.duration=t}get tag(){let t=this.info.tags.find((t=>t.name===this.st));if(!t)throw`notag ${this.it} ${this.st}`;return t}get it(){return this.data.name}get st(){return this.data.tag||"idle"}x=0;y=0;et=1;ht=1;nt(t,i){this.x=t,this.y=i}_current_frame=0;get D(){let{from:t}=this.tag;return this.info.l[this._current_frame+t]}get rt(){return this.data.rt??"c"}get I(){if("tl"===this.rt)return 0;let{A:t}=this.D;return"c"===this.rt||"bc"===this.rt?t/2:0}get U(){if("tl"===this.rt)return 0;let{u:t}=this.D;return"c"===this.rt?t/2:"bc"===this.rt?t:0}ot(t){this.data.tag!==t&&(this.data.tag=t,this._current_frame=0,this.lt=0)}lt=0;Z(){let{from:t,to:i}=this.tag,{duration:s}=this,e=s/(i-t+1),h=i-t;this.lt+=1e3*n.k,this.lt>=e&&(this.lt-=e,this._current_frame===h?!1!==this.data.loop&&(this._current_frame=0):this._current_frame+=1)}tt(t){let{x:i,y:s,et:e,ht:h}=this;t.v(this,i,s,e,h)}}const o=function(){let t=new Set;return document.addEventListener("keydown",(i=>{return s=i.key,void t.add(s);var s})),document.addEventListener("keyup",(i=>{return s=i.key,void t.delete(s);var s})),i=>[...t].includes(i)}();var l=function(){var t,i,s,e,h,n=function(t){return Math.sin(6.283184*t)},r=function(t){return.003959503758*2**((t-128)/12)},a=function(t,i,s){var e,h,n,a,l,A,c=o[t.At[0]],d=t.At[1],u=t.At[3]/32,f=o[t.At[4]],g=t.At[5],w=t.At[8]/32,_=t.At[9],B=t.At[10]*t.At[10]*4,M=t.At[11]*t.At[11]*4,x=t.At[12]*t.At[12]*4,E=1/x,m=-t.At[13]/16,p=t.At[14],C=s*2**(2-t.At[15]),Q=new Int32Array(B+M+x),v=0,D=0;for(e=0,h=0;e<B+M+x;e++,h++)h>=0&&(h-=C,l=r(i+(15&(p=p>>8|(255&p)<<4))+t.At[2]-128),A=r(i+(15&p)+t.At[6]-128)*(1+8e-4*t.At[7])),n=1,e<B?n=e/B:e>=B+M&&(n=(1-(n=(e-B-M)*E))*3**(m*n)),a=c(v+=l*n**u)*d,a+=f(D+=A*n**w)*g,_&&(a+=(2*Math.random()-1)*_),Q[e]=80*a*n|0;return Q},o=[n,function(t){return t%1<.5?1:-1},function(t){return t%1*2-1},function(t){var i=t%1*4;return i<2?i-1:3-i}];this.init=function(n){t=n,i=n.ct,s=0,e=n.dt*n.ut*(i+1)*2,h=new Int32Array(e)},this.ft=function(){var r,l,A,c,d,u,f,g,w,_,B,M,x,E,m=new Int32Array(e),p=t.gt[s],C=t.dt,Q=t.ut,v=0,D=0,y=!1,I=[];for(A=0;A<=i;++A)for(f=p.wt[A],c=0;c<Q;++c){var U=f?p.c[f-1].f[c]:0;U&&(p.At[U-1]=p.c[f-1].f[c+Q]||0,U<17&&(I=[]));var F=o[p.At[16]],R=p.At[17]/512,k=2**(p.At[18]-9)/C,H=p.At[19],K=p.At[20],L=43.23529*p.At[21]*3.141592/44100,S=1-p.At[22]/255,Y=1e-5*p.At[23],b=p.At[24]/32,O=p.At[25]/512,T=6.283184*2**(p.At[26]-9)/C,V=p.At[27]/255,N=p.At[28]*C&-2;for(B=(A*Q+c)*C,d=0;d<4;++d)if(u=f?p.c[f-1].n[c+d*Q]:0){I[u]||(I[u]=a(p,u,C));var P=I[u];for(l=0,r=2*B;l<P.length;l++,r+=2)m[r]+=P[l]}for(l=0;l<C;l++)(_=m[g=2*(B+l)])||y?(M=L,H&&(M*=F(k*g)*R+.5),D+=(M=1.5*Math.sin(M))*(x=S*(_-D)-(v+=M*D)),_=3==K?D:1==K?x:v,Y&&(_=(_*=Y)<1?_>-1?n(.25*_):-1:1,_/=Y),y=(_*=b)*_>1e-5,E=_*(1-(w=Math.sin(T*g)*O+.5)),_*=w):E=0,g>=N&&(E+=m[g-N+1]*V,_+=m[g-N]*V),m[g]=0|E,m[g+1]=0|_,h[g]+=0|E,h[g+1]+=0|_}return++s/t._t},this.Bt=function(t){for(var i=t.createBuffer(2,e/2,44100),s=0;s<2;s++)for(var n=i.getChannelData(s),r=s;r<e;r+=2)n[r>>1]=h[r]/65536;return i}};const A={gt:[{At:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],wt:[1,2,1,2,,,,,,1,2,1,2,,,2,1,,,1,2,1,2],c:[{n:[135,,,,,,,,139,,,,142,,,,147,,,,,,,,139],f:[]},{n:[142,,,,,,,,147,,,,139,,,,135,,,,,,,,135],f:[]}]},{At:[2,61,128,0,3,91,128,0,0,0,5,6,58,0,0,0,0,195,6,1,3,135,0,0,32,147,6,121,6],wt:[1,2,1,2,1,2,1,2,1,1,2,2,1,4,3,3,4,3,4,1,2,1,2],c:[{n:[,,,,135,,,,,,,,135,,,,,,,,147,,,,,,,,135,,,,,,,,139,,,,,,,,151,,,,,,,,139,,,,,,,,139,,,,,,,,154,,,,,,,,142,,,,,,,,142,,,,,,,,142],f:[]},{n:[,,,,147,,,,,,,,135,,,,,,,,135,,,,,,,,135,,,,,,,,139,,,,,,,,139,,,,,,,,151,,,,,,,,139,,,,,,,,142,,,,,,,,154,,,,,,,,142,,,,,,,,142],f:[]},{n:[144,,,,,,,,144,,,,,,,,144,,,,,,,,144,,,,,,,,139,,,,,,,,139,,,,,,,,139,,,,,,,,139,,,,,,,,135,,,,,,,,135,,,,,,,,135,,,,,,,,135],f:[]},{n:[144,,,,,,,,144,,,,,,,,156,,,,,,,,144,,,,,,,,139,,,,,,,,151,,,,,,,,139,,,,,,,,139,,,,,,,,147,,,,,,,,135,,,,,,,,135,,,,,,,,135],f:[]}]},{At:[1,104,128,0,0,99,116,9,0,28,17,15,25,135,106,0,0,186,3,1,1,23,167,0,32,77,6,13,1],wt:[,,1,2,1,1,2,2,,1,2,,,3,4,3,3,4,4,4,1,2],c:[{n:[135,,139,,154,,147,,135,,139,,154,,151,,139,,142,,151,,,,139,,142,,154],f:[]},{n:[139,,142,,154,,,,139,,142,,154,,,,154,,151,,147,,,,154,,151,,147],f:[]},{n:[144,,139,,144,,151,,135,,139,147,147,,,,135,,139,147,147,,,,135,,139,156,156],f:[]},{n:[151,,139,,151,,139,,156,,144,151,151,,,,151,,144,151,147,,,,147,,139,147,135],f:[]}]}],dt:7350,ut:32,ct:22,_t:3},c=function(){let t=new AudioContext,i=t.createGain();i.connect(t.destination);const s={},e=[{name:"song",data:A}];return{ft:()=>(e.forEach((i=>{let e=new l;e.init(i.data),function h(){if(1===e.ft()){let h=e.Bt(t);((t,i)=>{s[t]=i})(i.name,h)}else setTimeout(h,0)}()})),new Promise((t=>{!function i(){Object.keys(s).length!==e.length?setTimeout(i,100):t()}()}))),play:(e,h=!1)=>{const n=s[e];if(!n)return;let r=t.createBufferSource(),a=t.createGain();return r.buffer=n,r.connect(a),a.connect(i),r.loop=h,a.gain.value=.8,r.start(),()=>{r.stop()}}}}();function d(t,i,s){return t<i?Math.min(t+s,i):t>i?Math.max(t-s,i):t}function u(t,i){return t.x<i.x+i.w&&t.x+t.w>i.x&&t.y<i.y+i.t&&t.y+t.t>i.y}function f(t){let i;const s=e=>{i=new e,i.L({g:t,go:s}),i.init()};s(w),function(t){let i;const s=e=>{n.k=Math.min(20,Math.max(16,i?e-i:16))/1e3,i=e,n.time+=n.k,t(),requestAnimationFrame(s)};requestAnimationFrame(s)}((()=>{i.update(),t.clear(),t.fr(0,0,64,64,"hsl(20, 5%, 50%)"),t.fr(1,1,62,62,"hsl(70, 15%, 30%)"),i.draw(t)}))}class g extends r{Mt=!1;xt;get data(){return this.K}get g(){return this.data.g}go(t){this.data.go(t)}update(){o("m")?this.Mt||(this.Mt=!0,this.xt?(this.xt(),this.xt=void 0):this.xt=c.play("song",!0)):this.Mt=!1,super.update()}}class w extends g{W(){e.load().then((()=>{let t=this.J(a,{name:"loading",tag:"audio",duration:1e3});t.x=32,t.y=32,c.ft().then((()=>{this.go(_)}))}))}}class _ extends g{W(){this.J(U),this.J(B)}}class B extends r{width=0;Et=0;Ct(){this.Et=.9}W(){let t=this.J(a,{name:"collect",tag:"coin"});t.x=3,t.y=3}Z(){this.Et>0&&(this.Et=d(this.Et,0,3*n.k),this.Et<.5&&(this.width++,this.Et=0))}tt(t){t.fr(6,1,54,1,"#f7ffff"),t.fr(6,2,this.width,2,"#b4d800");let i=this.Et/.9*1;t.fr(6+this.width,2,i,2,"#f59562")}}class M extends r{get Qt(){return{x:this.x,y:this.y,w:this.w/2,t:this.t/2}}v;vt=!0;Dt=1;yt=.8;w=4;t=4;grid;dx=0;dy=0;x=0;y=0;It=0;Ut=0;Ft=this.Rt;kt;Ht;get Kt(){return Math.sign(this.dx)}get Lt(){return this.It<0}get Rt(){return this.It>0}get St(){return this.Ut<0}get Yt(){return this.Ut>0}draw(t){t.C(Math.floor(this.x),Math.floor(this.y)),super.draw(t),t.pop()}update(){super.update(),this.Ft=this.Rt}}class x extends M{Dt=0;get data(){return this.K}get duration(){return this.data.duration??1}W(){this.v=this.J(a,{name:this.data.name})}Z(){this.S>this.duration&&this.remove()}}class E extends x{Dt=.3;W(){this.v=this.J(a,{name:"crash"})}}class m extends M{bt}class p extends m{Dt=0;yt=64;Ot;W(){this.v=this.J(a,{name:"collect",tag:"coin",duration:800})}Z(){if(void 0!==this.Ot&&(this.Ot=d(this.Ot,0,n.k),this.Ot<2&&(n.H(.3)?this.visible&&(this.visible=!1):n.H(.2)&&(this.visible||(this.visible=!0))),0===this.Ot&&this.remove()),void 0!==this.bt){if(this.bt=d(this.bt,0,n.k),this.v.duration=160,0===this.bt){let t=this.parent.J(x,{name:"fx_collect",duration:.3});t.x=this.x,t.y=this.y,this.remove()}}else this.dy=Math.sin(3*this.S)}}class C extends M{}class Q extends C{w=8;t=8;W(){this.v=this.J(a,{name:"crawler"}),this.dx=1.2}Z(){this.v.et=this.Kt}}class v extends M{Dt=0;vt=!1;W(){this.J(a,{name:"main_char",tag:"die",loop:!1})}}class D extends M{w=8;t=8;Tt=0;Vt=0;Nt=2;Pt=0;Gt;Jt=!1;Xt=!1;W(){this.v=this.J(a,{name:"main_char"})}Z(){if(this.Tt>0)return void(this.Tt=d(this.Tt,0,n.k));let t=o("x"),i=o("ArrowLeft")||o("a"),s=o("ArrowRight")||o("d"),e=o("ArrowUp")||o("w");if(this.Jt=i,this.Xt=s,this.dx=i?-8:s?8:0,e?void 0!==this.Pt&&(this.Pt+=n.k):void 0===this.Pt?this.Pt=0:this.Pt>0&&(this.Pt=-.3),void 0!==this.Pt&&this.Pt<0&&(this.Pt+=n.k,this.Pt>=0&&(this.Pt=void 0)),void 0!==this.Pt&&this.Pt>0)if(void 0!==this.Gt)this.dy=-40,this.Pt=void 0,this.Nt=1;else if(this.Nt>0){this.dy=-40,this.Pt=void 0,this.Nt=0;let t=this.parent.J(x,{name:"fx_djump",duration:.4});t.x=this.x,t.y=this.y+5}if(this.Rt?this.Gt=0:this.Ft&&(this.Gt=.16),void 0!==this.Gt&&this.Gt>0&&(this.Gt=d(this.Gt,0,n.k),0===this.Gt&&(this.Gt=void 0)),this.Rt?0!==this.dx?(this.v.ot("run"),this.v.et=this.Kt):this.v.ot("idle"):(this.v.ot("jump"),0!==this.Kt&&(this.v.et=this.Kt)),t&&0===this.Vt){let t=this.parent.X(I,{dx:this.dx,dy:10});t.x=this.x,t.y=this.y,this.dx*=-6,this.Vt=.2}this.Vt=d(this.Vt,0,n.k)}q(){}}class y extends r{w=4;t=4;x;y;dx;dy;Z(){this.dy=Math.sin(8*this.S)*Math.sin(16*this.S)*20,this.S>1.5&&this.remove()}draw(t){t.C(Math.floor(this.x),Math.floor(this.y)),super.draw(t),t.pop()}}class I extends y{get data(){return this.K}W(){this.dx=2*this.data.dx,this.dy=this.data.dy,this.J(a,{name:"bullet"})}}class U extends r{get Wt(){return this.parent.P(B)}o;jt=0;Zt=0;zt=this.jt;qt=this.Zt;get $t(){return 4*this.o[0].length}ti(t,i,s){return!!this.ii(t,i,s)}ii(t,i,s){let{x:e,y:h,w:n,t:r}=t;return this.si(e-n/2+i,h-r/2+s,n,r)}si(t,i,s=1,e=1){let h=this.o[0].length,n=this.o.length,r=t/4,a=i/4,o=(t+s-1)/4,l=(i+e-1)/4;if(r<0||o>=h||a<0||l>=n)return!0;for(t=r;t<=o;t++)for(i=a;i<=l;i++)if(t=Math.floor(t),i=Math.floor(i),R(this.o[i][t]))return[4*t,4*i]}W(){let t=e.h[0];this.o=[];for(let i=0;i<t.t;i++)this.o[i]=Array(t.w);for(let i=0;i<t.i.length;i++){let{px:s,src:e}=t.i[i],h=s[0]/4,n=s[1]/4,r=e[1]/4*20+e[0]/4;if(399===r){let t=this.J(D);t.x=s[0],t.y=s[1]}else if(398===r){let t=this.J(Q);t.x=s[0],t.y=s[1]}else if(397===r){let t=this.J(p);t.x=s[0],t.y=s[1]}else this.o[n][h]=r}}Z(){let t=this.P(D);if(this.N(Q).forEach((t=>{!this.ti(t,Math.sign(t.dx),0)&&this.ti(t,4*Math.sign(t.dx),1)||(t.dx*=-1)})),0===t.Tt){this.Y.filter((t=>t instanceof m)).forEach((i=>{void 0===i.bt&&u(i,t)&&(i.bt=.3,i.dy=-8,this.Wt?.Ct())})),this.Y.filter((t=>t instanceof C)).forEach((i=>{if(u(i.Qt,t.Qt)){if(0===this.Wt.width){t.visible=!1;let i=this.J(v);i.x=t.x,i.y=t.y}t.J(x,{name:"fx_flash"}),t.Tt=1,t.dy=-32,0===t.dx?t.dx=6.4:t.dx=8*-Math.sign(t.dx)*.8;for(let i=0;i<this.Wt.width;i++){let s=this.J(p);s.x=t.x,s.y=t.y,s.dx=8*Math.sin(i/this.Wt.width*Math.PI*2),s.dy=80*Math.cos(i/this.Wt.width*Math.PI*2),s.Ot=3}this.Wt.width=0}}))}if(void 0===t.kt){let i=this.ti(t,0,2),s=this.ii(t,1,-1)?void 0:this.ii(t,1,0),e=this.ii(t,-1,-1)?void 0:this.ii(t,-1,0);i||(t.Xt&&Array.isArray(s)?(t.kt=.2,t.x=s[0],t.y=s[1]):t.Jt&&Array.isArray(e)&&(t.kt=-.2,t.x=e[0]+4,t.y=e[1]))}if(!t.kt&&void 0===t.Ht){let i=this.ii(t,1,-4)?void 0:this.ii(t,1,0),s=this.ii(t,-1,-4)?void 0:this.ii(t,-1,0);t.Xt&&Array.isArray(i)?(t.Ht=.16,t.x=i[0],t.y=i[1]-1):t.Jt&&Array.isArray(s)&&(t.Ht=-.16,t.x=s[0]+4,t.y=s[1]-1)}this.Y.filter((t=>t instanceof M)).forEach((t=>{let i=this.ii(t,0,0);if(void 0!==t.kt)return t.kt=d(t.kt,0,n.k),void(0===t.kt&&(t.kt=void 0,t.y=i[1]-4,t.dy=0));if(void 0!==t.Ht)return t.Ht=d(t.Ht,0,n.k),void(0===t.Ht&&(t.Ht=void 0,t.y=i[1]-4,t.dy=0));let s=4*t.Dt,e=0;{let i=Math.abs(t.dy),h=Math.sign(t.dy);for(let r=0;r<i;r+=1){let a=.5*h*Math.sqrt(n.k);if(this.ti(t,0,a)){t.It=h,t.dy/=2,e=0;break}t.It=0,t.y+=a,e=1-h*(r/i);{let i=t.yt*s*Math.sqrt(e),h=1;t.dy+=h*i*n.k}}}{let i=3*s,e=1;for(let s=0;s<i;s+=1){let i=.5*e*Math.sqrt(n.k);if(this.ti(t,0,i)){t.It=e,t.dy=0;break}t.It=0,t.y+=i}}{let i=Math.abs(t.dx),s=Math.sign(t.dx),e=1;for(let h=0;h<i;h+=1){let i=.5*s*Math.sqrt(n.k)*e;if(this.ti(t,i,0)){t.Ut=s,t.dx=0;break}t.Ut=0,t.x+=i}}})),t&&(this.zt<t.x-4-1&&(this.zt=t.x-4-1),this.zt>t.x+4+1&&(this.zt=t.x+4+1),this.qt<t.y-8&&(this.qt=t.y-8),this.qt>t.y+8&&(this.qt=t.y+8));let i=t.dx<0?-50:t.dx>0?-10:-32;this.jt=d(this.jt,this.zt+i,50*n.k),this.Zt=this.qt-32,this.jt=Math.min(Math.max(0,this.jt),this.$t),this.Y.filter((t=>t instanceof y)).forEach((t=>{{let i=Math.abs(t.dy),s=Math.sign(t.dy);for(let e=0;e<i;e+=1){let i=.5*s*Math.sqrt(n.k);if(this.ti(t,0,i)){t.dy/=2;break}t.y+=i;{let i=1,s=1;t.dy+=s*i*n.k}}}{let i=Math.abs(t.dx),s=Math.sign(t.dx),e=1;for(let h=0;h<i;h+=1){let i=.5*s*Math.sqrt(n.k)*e;if(this.ti(t,i,0)){t.dx=0;let i=this.X(E);i.x=t.x-2*s,i.y=t.y,i.v.et=s,this.remove(t);break}t.x+=i}}}))}$(t){t.C(-this.jt,-this.Zt);for(let i=0;i<this.o.length;i++){let s=this.o[i];for(let e=0;e<s.length;e++){let h=s[e];t.R(h,4*e,4*i)}}}tt(t){t.pop()}}const F=[0,1,2,3,4,5,20,21,22,23,24,40,41,42,44,60,61,62,63,64,80,81,82,83],R=t=>F.includes(t);!function(t){let i=function(t,i,s=!0){let e=document.createElement("canvas");s&&e.classList.add("pixelated");let n=e.getContext("2d");const r=()=>{e.width=t,e.height=i,n.imageSmoothingEnabled=s};return document.addEventListener("scroll",r,{capture:!0,passive:!0}),window.addEventListener("resize",r,{passive:!0}),r(),new h(e,n)}(64,64,!0);t.appendChild(i.canvas),f(i)}(document.getElementById("app"));
