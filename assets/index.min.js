const t=""+new URL("out_0-rh3THiV_.png",import.meta.url).href,i=[{n:"Level_0",w:112,t:27,i:"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"},{n:"Level_1",w:73,t:37,i:"AQSJAB8wIDBIXEhgR2RIZAdsCGwJbApsC2wMbBVsFmwdbCRsJWwrbAdwCHAJcApwC3AMcBVwFnAdcCRwJXArcAd0CHQJdAp0C3QMdBV0FnQddCR0JXQrdDeAEYgSiBOIFIgViBaIF4gYiBmIGogbiByIHYgkiCWIJogniCiIKYgqiCuILIgtiC6IL4gwiDGIMogziBGMEowTjBSMFYwWjBeMGIwZjBqMG4wcjB2MJIwljCaMJ4wojCmMKowrjCyMLYwujC+MMIwxjDKMM4wDkBGQEpATkBSQFZAWkBeQGJAZkBqQG5AckB2QHpAfkCCQIZAikCOQJJAlkCaQJ5AokCmQKpArkCyQLZAukC+QMJAxkDKQM5ABEAQAADAlRABUQ2gBDAYAAFAAfBGEHowAkASQAAwOAEdgRmRCaAZsQGw+cDx0Ong4fDaANIQjjAKQEJAABBgAHjA7SEdcFGwcbCNsKmwGcBRwHHAjcCpwBnQUdBx0I3QqdBB4EHwQgBCEEIgjiBCMAQgyAAEwAjADMAQwBTAOMA8wEDARMBIwEzAUMBUwFjAfNCA0O0xCUENQAVQCVANUBFQFVERoRWhGaEdoSGhBbEJsP3A9dAd4CHgJeAp4C3gMeBV4FngdeCR4JXgreDt4OXw1hDaEN4QCBC0AITAANAA4ADwAQABEAEg8SABMAFgAXABgAGQAaABsDWwXbB5sJmwsbABwDXAXcB5wJnAscAB0DXQXdB50JnQsdAB4EXgRfACAEYA4gACEAIgeiDSIAIw0jDSQAQBdAAAsASwCLAMsBCwFLA4sDywQLBEsEiwTLBQsFSwWLB8sICwlQEJMQ0wBUAJQA1AEUAVQSFhDZERkRWQHaAhoCWgKaAtoDGgVaBZoHWgkaCVoK2hBaD9sPXA7dDl4N3w1gBKEE4QUhBWEFoQXhBiEGYQahBuEHIQdhCSEJYQmhCeEKIQphCqEK4QshC2ELoQvhDCEMYQyhDOEA4wfjCCMIYwijAGQBZAGkAeQCJAJkAqQC5AMkA2QDpAPkAAICQANMB40JERBUAZ4FHgceCN4KngCCBIABjAXMCE0JkQ8TERQBlRDbEBwPnQNeBd4HngmeCx4PHg6fDiEAgAPAAYsFywhLCZAPERETAZQDWgXaB5oJmgsaBF0HoQEjAAAFwANLB4sJEA7REFMR1hGYEJkBmgUaBxoI2gqaEBoPmw8cBB0OnQ4eDZ8NIAjhAKMBAwCACEcJUgEAB8AIhgjGCsYLBg0GDUYPRg+GD8YKkwrTCxMLUwuTC9MMEwxTDJMM0w0TDVMNkw3TDhMOUw6TDBoMWgyaAVsAXwFAAYAJBgtGDYYQBgzaAJ8AwAGACoYMxg8GClML2gEbAIMAQAhGAMEAQAjUBNMAQAIXBJMBAA1FDJIIYgKjBFMIAAnDDAMOQxEEAIgBiALIA8gFCAYIBwgRCAgJDwwRDA6NAI4BTg+OEI8RDwCRAVEQkRERBVYKGAZcCBwKHAfgCKACAQOAA1QDlAPUBBQHFAgUBBUQXxAgD6EP4Q8iD2IPogHEAQAQCQfUA9UEFgIEAcAHVARVEN4QnxBgECEP4gIDAIAEVAhVAcMCQAPTAxQG1AwWEJ4QHw/gD2EO4gHBAIAEFwQYAgIFwAnKCgoMCgeUAtUDFQNVA5UElQZVBpUG1QcVCBUIlgjWDBcOWA6jDuMPIw9jD6MCQQIABwIDgxBJCFQEVgxWBFcEWAIABUAQCAnJCgkMCQNTA5MEEwcTB1MHkwfTCBMGlAiVDlcOlxDdEF4PoA8hDqIBwgNABsIDRA/JCYoLyhAKB9UD1ghWC9cOGAQZDmMCQgOAA4QKSgxKEEoHVQxXDpgEWREeEN8QoBBhECIP4wJAAoAHARBICkkMSQRTCFMElAjVDFURHQHABIAGwQNDD8gJiQvJAxMG0wLUBlQMFQvWDhcQnRAeD98PYA7hDmICwgGAAMIDggDDBIMFgwcDAsMBAADEBIQFhAcEAsEBQADBA4EEggWCA9IDAADABNUJFg8WAoAAgAKVBhUChABADtcCQwBADtYBhAXACIUAygEKAUoNEg3SENIA0wFTEdUQmAMZCRkNXwXgBiAG4AcgCSAJ4AugDCAIIgGABkAIxQsFDQUNhQCKB8oO0AwSDFISFRGXBRkFWQdZCVkQWQ+aD1sO3A5dBKAE4AWgCqAMYAGBBIALRQ/FA4oFSgWKDxALEg4SDlIREgKZA1kFmQQcDd4GYAdgCaABgwXAD0UQBQSKBMoFCgtSDNIQUhCSARMQ2BFYAhkC2Q8bDR8FIAagCiAKYArgC2AMoAGCBkAPhQBKA8oECgRKCAoJTwuSC9INUg2SAJMRGAGZAdkCWRAZD9oEXA6cDZ4FYAlgCyAL4A="},{n:"Level_2",w:40,t:103,i:"AQgOAAUwBjAHMAgwCTAKMAswDDANMA4wDzAQMBEwEjABAA4ABSwGLAcsCCwJLAosCywMLA0sDiwPLBAsESwSLAAIAQAEMAIIAQATMAIAAQATLAAAAQAELBNMAQAJKBFMAQARIA=="}];function s(t){function i(t){function i(t){return[4*(t%1024),4*Math.floor(t/1024)]}let s=[],n=function(t){const i=atob(t),s=i.length,n=new Uint8Array(s);for(let h=0;h<s;h++)n[h]=i.charCodeAt(h);return new Uint16Array(n.buffer)}(t);for(let h=0;h<n.length;){let t=n[h];h++;let A=n[h];h++;let e=[...n.slice(h,h+A)];h+=A,s.push(...e.map((s=>({src:i(t),px:i(s)}))))}return s}return t.map((t=>{let{n:s,w:n,t:h,i:A}=t;return{name:s,w:n,t:h,i:i(A)}}))}const n=new class{image;info;h;A;async load(){var n;this.image=await(n=t,new Promise((t=>{let i=new Image;i.onload=()=>t(i),i.src=n}))),this.info="bullet\n\n0*0*idle\n\n0*80*236\n\n\ncollect\n\n0*2*coin\n\n0*88*236\n0*96*236\n0*104*236\n\n\nconfetti\n\n0*3*idle\n\n0*112*236\n0*120*236\n0*128*236\n0*136*236\n\n\ncrash\n\n0*2*idle\n\n0*144*236\n0*152*236\n0*160*236\n\n\ncrawler\n\n0*1*idle\n\n0*168*236\n0*176*236\n\n\nend\n\n0*4*idle\n\n2*0*0\n2*80*0\n2*160*0\n2*0*80\n2*80*80\n\n\nflies\n\n0*7*idle\n8*13*run\n\n1*160*190\n1*176*190\n1*192*190\n1*208*190\n1*224*190\n1*240*190\n1*240*160\n1*240*80\n1*240*96\n1*240*112\n1*240*128\n1*240*144\n1*240*0\n1*240*16\n\n\nfx_collect\n\n0*2*idle\n\n0*184*236\n0*192*236\n0*200*236\n\n\nfx_djump\n\n0*1*idle\n\n0*208*236\n0*216*236\n\n\nfx_dust\n\n0*4*idle\n5*7*jump\n\n0*224*236\n0*232*236\n0*240*236\n0*248*236\n0*80*244\n0*88*244\n0*96*244\n0*104*244\n\n\nfx_flash\n\n0*1*idle\n\n0*112*244\n0*120*244\n\n\nloading\n\n0*1*audio\n2*4*input\n\n4*0*160\n4*80*160\n4*160*160\n4*0*190\n4*80*190\n\n\nmain_char\n\n0*2*idle\n3*6*victory\n7*12*run\n13*17*jump\n18*20*die\n\n0*128*244\n0*136*244\n0*144*244\n0*152*244\n0*160*244\n0*168*244\n0*176*244\n0*184*244\n0*192*244\n0*200*244\n0*208*244\n0*216*244\n0*224*244\n0*232*244\n0*240*244\n0*248*244\n0*160*206\n0*168*206\n0*176*206\n0*184*206\n0*192*206\n\n\nnpc\n\n0*0*idle\n\n3*0*220\n\n\nrestart\n\n0*2*idle\n3*6*bg\n\n1*48*220\n1*64*220\n1*80*220\n1*96*220\n1*112*220\n1*128*220\n1*144*220\n\n\ntest\n\n0*2*idle\n3*4*attack\n\n1*160*220\n1*176*220\n1*192*220\n1*208*220\n1*224*220\n\n\ntiles\n\n0*0*idle\n\n2*160*80\n\n\nvictory\n\n0*8*idle\n\n1*240*220\n1*240*32\n1*240*48\n1*240*64\n1*0*236\n1*16*236\n1*32*236\n1*48*236\n1*64*236".split(/\r?\n\r?\n\r?\n/).map((t=>{let[i,s,n]=t.split(/\r?\n\r?\n/);return{name:i,tags:s.split(/\r?\n/).map((t=>{let[i,s,n]=t.split("*");return{from:parseInt(i),to:parseInt(s),name:n}})),l:n.split(/\r?\n/).map((t=>{let[i,s,n,h,A,e,a,r]=function(t){let[i,s,n]=t,h=0,A=0,[e,a]=0===i?[8,8]:1===i?[16,16]:2===i?[80,80]:4===i?[80,30]:[0,0],[r,l]=[e,a];return[h,A,e,a,s,n,r,l]}(t.split("*").map((t=>parseInt(t))));return{fx:i,fy:s,o:n,B:h,u:A,M:e,C:a,F:r}}))}})),this.A=this.info.find((t=>"tiles"===t.name)).l[0],this.h=s(i)}};class h{constructor(t,i){this.canvas=t,this.D=i}get width(){return this.canvas.width}get height(){return this.canvas.height}clear(){let{D:t}=this;t.clearRect(0,0,this.width,this.height)}fr(t,i,s,n,h){let{D:A}=this;A.fillStyle=h,A.fillRect(t,i,s,n)}U(t,i){let{D:s}=this;s.save(),s.translate(Math.floor(t),Math.floor(i))}pop(){let{D:t}=this;t.restore()}_(t,i,s,n=1,h=1){let{fx:A,fy:e,u:a,M:r,C:l,F:o}=t.G,{p:g,I:B}=t,Q=i-A-g,c=s-e-B;this.m(Q,c,a,r,l,o,n,h)}R(t,i,s){let{fx:h,fy:A,u:e,M:a}=n.A,r=i-h,l=s-A,o=t%20*4,g=4*Math.floor(t/20);this.m(r,l,e+o,a+g,4,4)}m(t,i,s,h,A,e,a=1,r=1){let{D:l}=this,{image:o}=n;l.save();let g=A,B=e,Q=g*Math.abs(a),c=B*Math.abs(r);l.scale(Number(a.toFixed(2)),Number(r.toFixed(2))),a<0&&(t*=-1,t-=Q),r<0&&(i*=-1,i-=c),l.drawImage(o,s,h,g,B,Math.round(t),Math.round(i),Math.round(Q),Math.round(c)),l.restore()}}const A={V:16,time:0,Y(t,i=0){let{V:s,time:n}=this;return Math.floor((n-i-s)/t)<Math.floor((n-i)/t)}};class e{W;k(t){return this.W=t,this}visible=!0;parent;J;v;X;Z;N(t,i){this.Z.push([t,i])}constructor(){this.X=[],this.v=[],this.Z=[]}P(t){return this.v.filter((i=>i instanceof t))}T(t){return this.v.find((i=>i instanceof t))}L(t,i){let s=(new t).k(i).init();return s.parent=this,s}j(t,i={}){let s=this.L(t,i);return this.v.push(s),s}K(t,i={},s=7){let n=this.L(t,i);return this.v.push(n),this.X.push([n,s]),n}remove(t){if(!t)return void(this.parent?this.parent.remove(this):this.O());let i=this.v.indexOf(t);if(-1===i)throw"noscene rm";this.v.splice(i,1),i=this.X.findIndex((([i])=>i===t)),-1!==i&&this.X.splice(i,1),t.O()}init(){return this.J=0,this.S(),this}update(){0===this.J&&this.H(),this.v.forEach((t=>t.update())),this.J+=A.V,this.Z=this.Z.map((([t,i])=>(t-A.V<0&&i(),[t-A.V,i]))).filter((t=>t[0]>0)),this.X.slice(0).forEach((([t,i])=>{let s=this.X.filter((i=>i[0].constructor.name===t.constructor.name));if(s.length>i){let t=s[0][0];this.remove(t)}})),this.q(),this.$()}draw(t){this.visible&&(this.tt(t),this.v.forEach((i=>i.draw(t))),this.it(t))}O(){this.st()}S(){}H(){}q(){}$(){}it(t){}tt(t){}st(){}}class a extends e{get data(){return this.W}get info(){let t=n.info.find((t=>t.name===this.nt));if(!t)throw`nosprite ${this.nt}`;return t}get duration(){return this.data.duration??.4}set duration(t){this.data.duration=t}get tag(){let t=this.info.tags.find((t=>t.name===this.ht));if(!t)throw`notag ${this.nt} ${this.ht}`;return t}get nt(){return this.data.name}get ht(){return this.data.tag||"idle"}x=0;y=0;At=1;et=1;rt(t,i){this.x=t,this.y=i}_current_frame=0;get G(){let{from:t}=this.tag;return this.info.l[this._current_frame+t]}get lt(){return this.data.lt??"c"}get p(){if("tl"===this.lt)return 0;let{o:t}=this.G;return"c"===this.lt||"bc"===this.lt?t/2:0}get I(){if("tl"===this.lt)return 0;let{B:t}=this.G;return"c"===this.lt?t/2:"bc"===this.lt?t:0}ot(t){this.data.tag!==t&&(this.data.tag=t,this._current_frame=0,this.gt=0)}gt=0;q(){let{from:t,to:i}=this.tag,{duration:s}=this,n=s/(i-t+1),h=i-t;this.gt+=A.V,this.gt>=n&&(this.gt-=n,this._current_frame===h?!1!==this.data.loop&&(this._current_frame=0):this._current_frame+=1)}it(t){let{x:i,y:s,At:n,et:h}=this;t._(this,i,s,n,h)}}const r=function(){let t=new Set;return document.addEventListener("keydown",(i=>{return s=i.key,void t.add(s);var s})),document.addEventListener("keyup",(i=>{return s=i.key,void t.delete(s);var s})),i=>[...t].includes(i)}();var l=function(){var t,i,s,n,h,A=function(t){return Math.sin(6.283184*t)},e=function(t){return.003959503758*2**((t-128)/12)},a=function(t,i,s){var n,h,A,a,l,o,g=r[t.Bt[0]],B=t.Bt[1],Q=t.Bt[3]/32,c=r[t.Bt[4]],d=t.Bt[5],w=t.Bt[8]/32,u=t.Bt[9],M=t.Bt[10]*t.Bt[10]*4,C=t.Bt[11]*t.Bt[11]*4,E=t.Bt[12]*t.Bt[12]*4,F=1/E,D=-t.Bt[13]/16,f=t.Bt[14],U=s*2**(2-t.Bt[15]),x=new Int32Array(M+C+E),_=0,G=0;for(n=0,h=0;n<M+C+E;n++,h++)h>=0&&(h-=U,l=e(i+(15&(f=f>>8|(255&f)<<4))+t.Bt[2]-128),o=e(i+(15&f)+t.Bt[6]-128)*(1+8e-4*t.Bt[7])),A=1,n<M?A=n/M:n>=M+C&&(A=(1-(A=(n-M-C)*F))*3**(D*A)),a=g(_+=l*A**Q)*B,a+=c(G+=o*A**w)*d,u&&(a+=(2*Math.random()-1)*u),x[n]=80*a*A|0;return x},r=[A,function(t){return t%1<.5?1:-1},function(t){return t%1*2-1},function(t){var i=t%1*4;return i<2?i-1:3-i}];this.init=function(A){t=A,i=A.Qt,s=0,n=A.ct*A.dt*(i+1)*2,h=new Int32Array(n)},this.wt=function(){var e,l,o,g,B,Q,c,d,w,u,M,C,E,F,D=new Int32Array(n),f=t.ut[s],U=t.ct,x=t.dt,_=0,G=0,p=!1,I=[];for(o=0;o<=i;++o)for(c=f.Mt[o],g=0;g<x;++g){var m=c?f.c[c-1].f[g]:0;m&&(f.Bt[m-1]=f.c[c-1].f[g+x]||0,m<17&&(I=[]));var R=r[f.Bt[16]],V=f.Bt[17]/512,Y=2**(f.Bt[18]-9)/U,W=f.Bt[19],k=f.Bt[20],J=43.23529*f.Bt[21]*3.141592/44100,v=1-f.Bt[22]/255,X=1e-5*f.Bt[23],Z=f.Bt[24]/32,N=f.Bt[25]/512,b=6.283184*2**(f.Bt[26]-9)/U,y=f.Bt[27]/255,P=f.Bt[28]*U&-2;for(M=(o*x+g)*U,B=0;B<4;++B)if(Q=c?f.c[c-1].n[g+B*x]:0){I[Q]||(I[Q]=a(f,Q,U));var T=I[Q];for(l=0,e=2*M;l<T.length;l++,e+=2)D[e]+=T[l]}for(l=0;l<U;l++)(u=D[d=2*(M+l)])||p?(C=J,W&&(C*=R(Y*d)*V+.5),G+=(C=1.5*Math.sin(C))*(E=v*(u-G)-(_+=C*G)),u=3==k?G:1==k?E:_,X&&(u=(u*=X)<1?u>-1?A(.25*u):-1:1,u/=X),p=(u*=Z)*u>1e-5,F=u*(1-(w=Math.sin(b*d)*N+.5)),u*=w):F=0,d>=P&&(F+=D[d-P+1]*y,u+=D[d-P]*y),D[d]=0|F,D[d+1]=0|u,h[d]+=0|F,h[d+1]+=0|u}return++s/t.Ct},this.Et=function(t){for(var i=t.createBuffer(2,n/2,44100),s=0;s<2;s++)for(var A=i.getChannelData(s),e=s;e<n;e+=2)A[e>>1]=h[e]/65536;return i}};const o={ut:[{Bt:[1,130,128,0,1,128,116,9,0,25,6,22,34,0,0,0,0,69,3,0,2,23,167,0,32,77,6,25,6],Mt:[1,2,1,2,,,1,2,1,2,1,2,,2,1],c:[{n:[135,139,142,135,139,142,135,139,142,135,139,142,135,139,142,135,141,144,139,141,144,139,141,144,139,141,144,139,141,144,139,141,147,,,147,,,147,,,147,,,147,,,147,,156,,,156,,,156,,,156,,,156],f:[]},{n:[142,146,137,142,146,137,142,146,137,142,146,137,142,146,137,140,144,135,140,144,135,140,144,135,140,144,135,140,144,135,140,144,154,,,154,,,154,,,154,,,154,,,152,,,152,,,152,,,152,,,152,,,152],f:[]}]},{Bt:[0,68,128,0,3,91,128,6,0,0,25,40,101,37,102,0,1,55,8,0,1,53,61,26,27,84,6,144,4],Mt:[,,2,2,,,,,,,,,,,,3],c:[{n:[],f:[]},{n:[135,,,,,,,,139,,,,,,,,135,,,,,,,,139,,,,,,,,151,,,,,,,,144,,,,,,,,139,,,,,,,,144,,,,,,,,142,,,,,,,,141,,,,,,,,142,,,,,,,,141],f:[]},{n:[135,,,,,,,,,,,,135,,,,,,,,,,,,135,,,,,,,,,,,,137,,,,,,,,,,,,139,,,,,,,,,,,,147],f:[]}]},{Bt:[2,60,127,28,2,83,138,0,27,0,61,28,65,11,0,0,2,0,0,0,2,118,56,0,91,146,4,0,2],Mt:[,,2,2,,,,,,,,,,,,3],c:[{n:[],f:[]},{n:[135,,,,,,,,,,,,,,,,135],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147,,,,,,,,,,,,,,,,147],f:[]}]},{Bt:[3,255,116,79,0,255,116,0,83,123,4,6,69,52,0,0,0,184,11,1,2,14,0,0,32,0,0,0,0],Mt:[,,,,2,2,2,1,2,2,1,1,,,2,,1],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,135,,,,,,135,,,135,,,135,,,,,,135,,,135,,,135],f:[]},{n:[,,141,,,141,,,141,,,141,,,141,,,141,,,141,,,141,,,141,,,141],f:[]}]},{Bt:[0,39,117,24,0,51,110,0,64,0,4,6,35,0,0,0,0,0,0,0,2,14,0,1,39,76,5,0,0],Mt:[,,,,,,,,,,,,,,,2,2],c:[{n:[],f:[]},{n:[,151,,151,,151,,151,,151,,151,,151,,151,,151,,151,,151,,151,,151,,151,,151,,151],f:[]}]},{Bt:[0,0,140,0,0,0,140,0,0,81,4,10,47,55,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],Mt:[,,,,2,,2,2,2,2,2,2,2,,2],c:[{n:[],f:[]},{n:[135,,,,,,147,,,,,,135,,,,,,147,,,,,,135,,,,,,147],f:[]}]},{Bt:[0,51,128,64,0,59,128,0,64,210,4,7,52,85,0,0,0,60,4,1,2,255,0,0,32,61,5,32,2],Mt:[,,,,,2,2,2,2,2,,,2,2],c:[{n:[],f:[]},{n:[,147,,,135,,,135,,,135,,,147,,,135,,,135,,,147,,,135,,,135,,,147],f:[]}]},{Bt:[1,127,118,0,1,128,128,10,0,0,21,0,59,12,0,0,0,69,3,1,1,23,167,0,32,77,6,25,6],Mt:[,,,,2,2,,,2,2,2,2,2],c:[{n:[],f:[]},{n:[135,139,142,135,139,142,135,139,142,135,139,142,135,139,142,135,141,144,139,141,144,139,141,144,139,141,144,139,141,144,139,141,147,,,147,,,147,,,147,,,147,,,147,,156,,,156,,,156,,,156,,,156],f:[]}]}],ct:6615,dt:32,Qt:16,Ct:8},g=t=>({ut:[{Bt:[1,109,120,0,0,53,120,4,0,0,15,0,48,15,50,2,1,0,0,0,2,255,96,0,37,24,1,67,1],Mt:[1],c:[{n:[t],f:[]}]}],ct:5513,dt:32,Qt:0,Ct:1}),B=[g(151),g(161),g(171)],Q={ut:[{Bt:[3,182,119,63,1,67,129,10,4,0,11,2,138,215,0,0,1,164,12,0,2,94,148,57,32,0,9,0,0],Mt:[1],c:[{n:[137],f:[]}]}],ct:5513,dt:32,Qt:0,Ct:1},c=t=>({ut:[{Bt:[0,100,125,0,0,201,131,2,0,0,5,0,39,0,134,3,0,195,6,0,2,44,60,1,39,0,10,0,0],Mt:[1],c:[{n:[t],f:[]}]}],ct:5513,dt:32,Qt:0,Ct:1}),d=[c(135),c(147)],w=function(){let t=new AudioContext,i=t.createGain();i.connect(t.destination);const s={},n=[{name:"song",data:o},{name:"pickup0",data:B[0]},{name:"pickup1",data:B[1]},{name:"pickup2",data:B[2]},{name:"damage",data:Q},{name:"jump",data:d[0]},{name:"djump",data:d[1]}];return{wt:()=>(n.forEach((i=>{let n=new l;n.init(i.data),function h(){if(1===n.wt()){let h=n.Et(t);((t,i)=>{s[t]=i})(i.name,h)}else setTimeout(h,0)}()})),new Promise((t=>{!function i(){Object.keys(s).length!==n.length?setTimeout(i,100):t()}()}))),play:(n,h=!1,A=.8)=>{const e=s[n];if(!e)return;let a=t.createBufferSource(),r=t.createGain();return a.buffer=e,a.connect(r),r.connect(i),a.loop=h,r.gain.value=A,a.start(),()=>{a.stop()}}}}();function u(t,i,s){return t<i?Math.min(t+s,i):t>i?Math.max(t-s,i):t}function M(t,i){return t.x<i.x+i.w&&t.x+t.w>i.x&&t.y<i.y+i.t&&t.y+t.t>i.y}function C(t){let i;const s=(n,h)=>{i&&i.remove(),i=(new n).k(h),i.g=t,i.go=s,i.init()};s(F),function(t){let i;const s=n=>{A.V=Math.min(20,Math.max(16,i?n-i:16))/1e3,i=n,A.time+=A.V,t(),requestAnimationFrame(s)};requestAnimationFrame(s)}((()=>{i.update(),t.clear(),t.fr(0,0,64,64,"hsl(20, 5%, 50%)"),t.fr(1,1,62,62,"hsl(70, 15%, 30%)"),i.draw(t)}))}class E extends e{Ft=!1;Dt;g;go;update(){r("m")?this.Ft||(this.Ft=!0,this.Dt?(this.Dt(),this.Dt=void 0):this.Dt=w.play("song",!0)):this.Ft=!1,super.update()}O(){super.O(),this.Dt?.()}}class F extends E{S(){n.load().then((()=>{let t=this.j(a,{name:"loading",tag:"audio",duration:1});t.x=32,t.y=32,w.wt().then((()=>{this.go(f,{level:2})}))}))}}class D extends E{S(){let t=this.j(a,{name:"end"});t.x=32,t.y=32}q(){this.J>4&&r("x")&&this.go(f,{level:1})}}class f extends E{get data(){return this.W}ft;Ut;S(){this.Dt=w.play("song",!0,.1),this.ft=this.j(N,{level:this.data.level}),this.Ut=this.j(U)}q(){this.ft.T(k)&&r("x")&&this.go(f,{level:this.data.level}),(this.Ut.T(x)?.J??0)>4&&(3===this.data.level?this.go(D):this.go(f,{level:this.data.level+1}))}}class U extends e{width=0;xt=0;_t;Gt;It(){this.xt>0&&this.width++,this.xt=.9,w.play("pickup"+Math.floor(3*Math.random()))}get done(){return this.width===this.Rt}S(){let t=this.j(a,{name:"collect",tag:"coin"});t.x=3,t.y=3}q(){if(this.xt>0&&(this.xt=u(this.xt,0,3*A.V),this.xt<.5&&(this.width++,this.xt=0)),this._t&&this._t>0&&(this._t=u(this._t,0,3*A.V),0===this._t)){this._t=void 0;let t=this.j(a,{name:"restart",tag:"bg",duration:.8});t.x=32,t.y=32,this.Gt=this.j(a,{name:"restart",duration:5}),this.Gt.x=32,this.Gt.y=32}this.Gt&&(this.Gt.y=32+4*Math.sin(8*this.J))}Rt=0;it(t){t.fr(6,1,this.Rt,1,"#f7ffff"),t.fr(6,2,this.width,2,"#b4d800");let i=this.xt/.9*1;t.fr(6+this.width,2,i,2,"#f59562")}}class x extends e{S(){let t=this.j(a,{name:"victory",duration:1});t.x=32,t.y=20}}class _ extends e{get Vt(){return{x:this.x,y:this.y,w:this.w/2,t:this.t/2}}_;Yt=!0;Wt=1;kt=.8;w=4;t=4;grid;dx=0;dy=0;x=0;y=0;Jt=0;vt=0;Xt=this.Zt;Nt;bt;get yt(){return Math.sign(this.dx)}get Pt(){return this.Jt<0}get Zt(){return this.Jt>0}get Tt(){return this.vt<0}get Lt(){return this.vt>0}draw(t){t.U(Math.floor(this.x),Math.floor(this.y)),super.draw(t),t.pop()}update(){super.update(),this.Xt=this.Zt}}class G extends _{Wt=0;get data(){return this.W}get duration(){return this.data.duration??1}S(){this._=this.j(a,{name:this.data.name,tag:this.data.tag})}q(){this.J>this.duration&&this.remove()}}class p extends G{S(){this._=this.j(a,{name:"confetti"})}q(){this.y-=(1*Math.sin(3*this.J)+12)*A.V}it(t){t.U(this.x+3*Math.sin(4*this.J),this.y),this._.it(t),t.pop()}}class I extends G{Wt=.3;S(){this._=this.j(a,{name:"crash"})}}class m extends _{jt}class R extends m{Wt=0;kt=64;Kt;Ot;St;S(){this._=this.j(a,{name:"collect",tag:"coin",duration:.8})}q(){if(void 0!==this.Kt&&(this.Kt=u(this.Kt,0,A.V),this.Kt<2&&(A.Y(.3)?this.visible&&(this.visible=!1):A.Y(.1)&&(this.visible||(this.visible=!0))),0===this.Kt&&(this.parent.Ht(),this.remove())),void 0!==this.jt){if(this.jt=u(this.jt,0,A.V),this._.duration=.16,0===this.jt){let t=this.parent.j(G,{name:"fx_collect",duration:.3});t.x=this.x,t.y=this.y,this.parent.zt(this),this.remove()}}else this.dy=Math.sin(3*this.J)}}class V extends _{}class Y extends V{w=8;t=8;S(){this._=this.j(a,{name:"crawler"}),this.dx=1.2}q(){this._.At=this.yt}}class W extends _{Wt=0;S(){this._=this.j(a,{name:"flies",duration:1})}}class k extends _{Wt=0;Yt=!1;S(){this.j(a,{name:"main_char",tag:"die",loop:!1})}}class J extends _{S(){this.j(a,{name:"main_char",tag:"victory"})}}class v extends _{w=8;t=8;qt=0;$t=0;ti=2;ii=0;si;ni=!1;hi=!1;S(){this._=this.j(a,{name:"main_char"})}q(){if(this.qt>0)return void(this.qt=u(this.qt,0,A.V));let t=r("x"),i=r("ArrowLeft")||r("a"),s=r("ArrowRight")||r("d"),n=r("ArrowUp")||r("w");if(this.ni=i,this.hi=s,this.dx=i?-8:s?8:0,n?void 0!==this.ii&&(this.ii+=A.V):void 0===this.ii?this.ii=0:this.ii>0&&(this.ii=-.3),void 0!==this.ii&&this.ii<0&&(this.ii+=A.V,this.ii>=0&&(this.ii=void 0)),void 0!==this.ii&&this.ii>0)if(void 0!==this.si)this.dy=-40,this.ii=void 0,this.ti=1,w.play("jump");else if(this.ti>0){this.dy=-40,this.ii=void 0,this.ti=0,w.play("djump");let t=this.parent.j(G,{name:"fx_djump",duration:.4});t.x=this.x,t.y=this.y+5}if(this.Zt?this.si=0:this.Xt&&(this.si=.16),void 0!==this.si&&this.si>0&&(this.si=u(this.si,0,A.V),0===this.si&&(this.si=void 0)),this.Zt?0!==this.dx?(this._.ot("run"),this._.At=this.yt):this._.ot("idle"):(this._.ot("jump"),0!==this.yt&&(this._.At=this.yt)),t&&0===this.$t){let t=this.parent.K(Z,{dx:this.dx,dy:10});t.x=this.x,t.y=this.y,this.dx*=-6,this.$t=.2}this.$t=u(this.$t,0,A.V)}$(){}}class X extends e{w=4;t=4;x;y;dx;dy;q(){this.dy=Math.sin(8*this.J)*Math.sin(16*this.J)*20,this.J>1.5&&this.remove()}draw(t){t.U(Math.floor(this.x),Math.floor(this.y)),super.draw(t),t.pop()}}class Z extends X{get data(){return this.W}S(){this.dx=2*this.data.dx,this.dy=this.data.dy,this.j(a,{name:"bullet"})}}class N extends e{Ai=[];zt(t){t.Ot&&this.Ai.push([t.Ot,t.St])}Ht(){let t=this.Ai.pop();if(t){let i=this.j(R);i.x=t[0],i.y=t[1],i.Ot=t[0],i.St=t[1]}}get data(){return this.W}get Ut(){return this.parent.T(U)}A;ei=0;ai=0;ri=this.ei;li=this.ai;get oi(){return 4*this.A[0].length}gi(t,i,s){return!!this.Bi(t,i,s)}Bi(t,i,s){let{x:n,y:h,w:A,t:e}=t;return this.Qi(n-A/2+i,h-e/2+s,A,e)}Qi(t,i,s=1,n=1){let h=this.A[0].length,A=this.A.length,e=t/4,a=i/4,r=(t+s-1)/4,l=(i+n-1)/4;if(e<0||r>=h||a<0||l>=A)return!0;for(t=e;t<=r;t++)for(i=a;i<=l;i++)if(t=Math.floor(t),i=Math.floor(i),y(this.A[i][t]))return[4*t,4*i]}S(){let t=n.h[this.data.level-1];this.A=[];for(let s=0;s<t.t;s++)this.A[s]=Array(t.w);let i=0;for(let s=0;s<t.i.length;s++){let{px:n,src:h}=t.i[s],A=n[0]/4,e=n[1]/4,a=h[1]/4*20+h[0]/4;if(399===a){let t=this.j(v);t.x=n[0],t.y=n[1];let i=this.j(W);i.x=n[0],i.y=n[1]-8}else if(398===a){let t=this.j(Y);t.x=n[0],t.y=n[1]}else if(397===a){let t=this.j(R);t.x=n[0],t.y=n[1],t.Ot=n[0],t.St=n[1],i++}else this.A[e][A]=a}this.ci=i}ci=0;H(){this.Ut.Rt=this.ci}q(){let t=this.T(v);if(t&&this.Ut.done){let i=this.j(J);i.x=t.x,i.y=t.y,t.remove(),this.T(W)?.remove(),this.Ut.j(x)}if(this.P(Y).forEach((t=>{!this.gi(t,Math.sign(t.dx),0)&&this.gi(t,4*Math.sign(t.dx),1)||(t.dx*=-1)})),t&&0===t.qt){this.v.filter((t=>t instanceof m)).forEach((i=>{void 0===i.jt&&M(i,t)&&(i.jt=.3,i.dy=-8,this.Ut?.It())})),this.v.filter((t=>t instanceof V)).forEach((i=>{if(M(i.Vt,t.Vt)){if(0===this.Ut.width){t.remove();let i=this.j(k);i.x=t.x,i.y=t.y,this.Ut._t=2}t.j(G,{name:"fx_flash"}),w.play("damage"),t.qt=.6,t.dy=-32,0===t.dx?t.dx=6.4:t.dx=8*-Math.sign(t.dx)*.8;for(let i=0;i<this.Ut.width;i++){let s=this.j(R);s.x=t.x,s.y=t.y,s.dx=8*Math.sin(i/this.Ut.width*Math.PI*2),s.dy=80*Math.cos(i/this.Ut.width*Math.PI*2),s.Kt=5}this.Ut.width=0}}))}if(t&&void 0===t.Nt){let i=this.gi(t,0,2),s=this.Bi(t,1,-1)?void 0:this.Bi(t,1,0),n=this.Bi(t,-1,-1)?void 0:this.Bi(t,-1,0);i||(t.hi&&Array.isArray(s)?(t.Nt=.2,t.x=s[0],t.y=s[1]):t.ni&&Array.isArray(n)&&(t.Nt=-.2,t.x=n[0]+4,t.y=n[1]))}if(t&&!t.Nt&&void 0===t.bt){let i=this.Bi(t,1,-4)?void 0:this.Bi(t,1,0),s=this.Bi(t,-1,-4)?void 0:this.Bi(t,-1,0);t.hi&&Array.isArray(i)?(t.bt=.16,t.x=i[0],t.y=i[1]-1):t.ni&&Array.isArray(s)&&(t.bt=-.16,t.x=s[0]+4,t.y=s[1]-1)}this.v.filter((t=>t instanceof _)).forEach((t=>{let i=this.Bi(t,0,0);if(void 0!==t.Nt)return t.Nt=u(t.Nt,0,A.V),void(0===t.Nt&&(t.Nt=void 0,t.y=i[1]-4,t.dy=0));if(void 0!==t.bt)return t.bt=u(t.bt,0,A.V),void(0===t.bt&&(t.bt=void 0,t.y=i[1]-4,t.dy=0));let s=4*t.Wt,n=0;{let i=Math.abs(t.dy),h=Math.sign(t.dy);for(let e=0;e<i;e+=1){let a=.5*h*Math.sqrt(A.V);if(this.gi(t,0,a)){t.Jt=h,t.dy/=2,n=0;break}t.Jt=0,t.y+=a,n=1-h*(e/i);{let i=t.kt*s*Math.sqrt(n),h=1;t.dy+=h*i*A.V}}}{let i=3*s,n=1;for(let s=0;s<i;s+=1){let i=.5*n*Math.sqrt(A.V);if(this.gi(t,0,i)){t.Jt=n,t.dy=0;break}t.Jt=0,t.y+=i}}{let i=Math.abs(t.dx),s=Math.sign(t.dx),n=1;for(let h=0;h<i;h+=1){let i=.5*s*Math.sqrt(A.V)*n;if(this.gi(t,i,0)){t.vt=s,t.dx=0;break}t.vt=0,t.x+=i}}}));let i=this.T(J);if(i&&A.Y(.6))for(let A=0;A<4;A++){let t=this.j(p);t.x=A/3*64+3*Math.sin(6*this.J),t.y=64}let s=t||i;if(s&&(this.ri<s.x-4-1&&(this.ri=s.x-4-1),this.ri>s.x+4+1&&(this.ri=s.x+4+1),this.li<s.y-8&&(this.li=s.y-8),this.li>s.y+8&&(this.li=s.y+8)),s){let t=s.dx<0?-50:s.dx>0?-10:-32;this.ei=u(this.ei,this.ri+t,50*A.V),this.ai=this.li-32,this.ei=Math.min(Math.max(0,this.ei),this.oi)}this.T(k)&&(this.ei=u(this.ei,this.ei+8*Math.sin(9*this.J),8*A.V),this.ai=u(this.ai,this.ai+8*Math.cos(9*this.J),8*A.V)),this.v.filter((t=>t instanceof X)).forEach((t=>{{let i=Math.abs(t.dy),s=Math.sign(t.dy);for(let n=0;n<i;n+=1){let i=.5*s*Math.sqrt(A.V);if(this.gi(t,0,i)){t.dy/=2;break}t.y+=i;{let i=1,s=1;t.dy+=s*i*A.V}}}{let i=Math.abs(t.dx),s=Math.sign(t.dx),n=1;for(let h=0;h<i;h+=1){let i=.5*s*Math.sqrt(A.V)*n;if(this.gi(t,i,0)){t.dx=0;let i=this.K(I);i.x=t.x-2*s,i.y=t.y,i._.At=s,this.remove(t);break}t.x+=i}}}));let n=this.T(W);n&&t&&(n.x=u(n.x,t.x+4*Math.cos(8*t.J),30*A.V),n.y=u(n.y,t.y-8+8*Math.sin(8*t.J),26*A.V),Math.abs(n.x-t.x)+Math.abs(n.y-t.y)<=16?n._.ot("idle"):n._.ot("run"),n._.At=t._.At);let h="none";if(t&&t.Zt&&0!==t.dx&&A.Y(.3+.5*Math.random())&&(h="idle"),t&&!t?.Xt&&t.Zt&&(h="jump"),t&&"none"!==h){let i=this.j(G,{name:"fx_dust",tag:h,duration:.4});i.x=t.x,"idle"===h&&(i.x+=4*-Math.sign(t.dx)),i.y=t.y,i._.At=Math.max(1,Math.sign(t.dx))}}tt(t){t.U(-this.ei,-this.ai);for(let i=0;i<this.A.length;i++){let s=this.A[i];for(let n=0;n<s.length;n++){let h=s[n];t.R(h,4*n,4*i)}}}it(t){t.pop()}}const b=[0,1,2,3,4,5,20,21,22,23,24,40,41,42,44,60,61,62,63,64,80,81,82,83],y=t=>b.includes(t);!function(t){let i=function(t,i,s=!0){let n=document.createElement("canvas");s&&n.classList.add("pixelated");let A=n.getContext("2d");const e=()=>{n.width=t,n.height=i,A.imageSmoothingEnabled=s};return document.addEventListener("scroll",e,{capture:!0,passive:!0}),window.addEventListener("resize",e,{passive:!0}),e(),new h(n,A)}(64,64,!0);t.appendChild(i.canvas),C(i)}(document.getElementById("app"));
